#!/bin/bash

echo "ðŸ”§ Updating Twilio Webhooks for Production"
echo "=========================================="

# Current webhook URLs (from your screenshot)
echo "ðŸ“‹ Current webhook URLs:"
echo "   Voice: https://v0dashboard-loxvef6im-kaisarkinnovations.vercel.app/api/twilio/voice/smart-routing"
echo "   SMS: https://v0dashboard-loxvef6im-kaisarkinnovations.vercel.app/api/sms/webhook"
echo ""

# New webhook URLs (for current deployment)
echo "ðŸŽ¯ Recommended webhook URLs:"
echo "   Voice: https://garagemanagerpro.vercel.app/api/voice/webhook"
echo "   SMS: https://garagemanagerpro.vercel.app/api/webhooks/communication-responses"
echo "   WhatsApp: https://garagemanagerpro.vercel.app/api/webhooks/communication-responses"
echo "   Status Callback: https://garagemanagerpro.vercel.app/api/webhooks/status-callback"
echo ""

# Test current webhook configuration
echo "ðŸ§ª Testing current webhook configuration..."
curl -s http://localhost:3000/api/twilio/configure-webhooks | jq .

echo ""
echo "ðŸ”§ To update webhooks automatically, run:"
echo "curl -X POST http://localhost:3000/api/twilio/configure-webhooks \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{\"baseUrl\": \"https://garagemanagerpro.vercel.app\", \"updateSMS\": true, \"updateVoice\": true, \"updateStatusCallback\": true}'"

echo ""
echo "ðŸ“± MANUAL UPDATE INSTRUCTIONS:"
echo "=============================="
echo "1. Go to: https://console.twilio.com/us1/develop/phone-numbers/manage/incoming"
echo "2. Click on: +447488896449"
echo "3. Update these URLs:"
echo "   â€¢ Voice URL: https://garagemanagerpro.vercel.app/api/voice/webhook"
echo "   â€¢ SMS URL: https://garagemanagerpro.vercel.app/api/webhooks/communication-responses"
echo "   â€¢ Status Callback: https://garagemanagerpro.vercel.app/api/webhooks/status-callback"
echo "4. Set all methods to: POST"
echo "5. Save configuration"
echo ""
echo "ðŸ“± WHATSAPP SETUP:"
echo "=================="
echo "1. Go to: https://console.twilio.com/us1/develop/sms/senders/whatsapp-senders"
echo "2. Click: 'Register a WhatsApp Sender'"
echo "3. Enter: +447488896449"
echo "4. Business Name: ELI MOTORS LTD"
echo "5. Complete business verification process"
